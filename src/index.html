<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PharmaNexus – Global Pharma City Network</title>
    <link rel="stylesheet" href="./styles/styles.css" />
    <link rel="stylesheet" href="./styles/map1.css" />
    <link rel="stylesheet" href="./styles/team.css" />
    <link rel="stylesheet" href="./styles/home.css" />
    <link rel="stylesheet" href="./styles/navbar.css" />
    <link rel="stylesheet" href="./styles/styleHu.css"/>
    <link rel="stylesheet" href="./styles/page2.css"/>
    <link rel="stylesheet" href="./styles/bubble.css"/>

    <!-- Mapbox CDN -->
    <script src="https://api.tiles.mapbox.com/mapbox-gl-js/v3.3.0/mapbox-gl.js"></script>
    <link href="https://api.tiles.mapbox.com/mapbox-gl-js/v3.3.0/mapbox-gl.css" rel="stylesheet" />
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script type="module" src="js/1map_imexport.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2"></script>

    <script src="https://unpkg.com/deck.gl@latest/dist.min.js"></script>

</head>

<body>
    <header class="navbar">
        <div class="logo">PharmaNexus</div>
        <div class="menu-toggle" onclick="toggleMenu()">☰</div>
        <div class="sidebar" id="sidebar">
            <a href="#home">Home</a>
            <a href="#map">Map</a>
            <a href="#data">Data</a>
            <a href="#Team">Team</a>
            <a href="#about">About</a>
        </div>
    </header>

    <main>
        <!-- 封面页！！ -->
        <section class="hero" id="home">
            <div class="hero-wrapper">
                <div class="hero-text">
                    <h1>
                        <span id="typed-line1">Connecting Cities,</span><br>
                        <span id="typed-line2">Through Pharmaceutical.</span>
                    </h1>
                    <p>
                        Revealing the global pharmaceutical network through dynamic visualizations of city connections, trade structures, and spatial complexity.
                    </p>
                </div>
                <div class="hero-3d">
                    <iframe src='https://my.spline.design/aheadpill-ZYVJSqnWfJ0Wzf8LNnxBUetX/' frameborder='0' width='100%' height='100%'></iframe>
                    <div class="spline-cover"></div>
                </div>
            </div>
        </section>

        <!-- 第二页的切入 -->
        <section class="page2" id="page2">
            <div class="page2-container">
                <h2 class="page2-title">Pharmaceutical Flows in the Global City Network</h2>
                <p class="page2-text">
                    As the pharmaceutical and biotechnology industries continue to globalize, corporate networks are increasingly shaping urban hierarchies.
                    While traditional studies focused on finance and legal services, our project uncovers how headquarters, subsidiaries, and R&D hubs 
                    form a multilayered city network of control, prestige, and function.
                </p>

                <p class="page2-text">
                    Building on Krätke’s framework of relational power and prestige, we explore cities like London, Basel, and New York as dominant control centers,
                    while highlighting overlooked but important nodes such as Copenhagen and Taipei. This project reveals the hidden architecture of 
                    pharmaceutical globalization and offers a spatial perspective on industrial resilience.
                </p>

                <div class="page2-keywords">
                    <div class="keyword-card">
                        <h3>Relational Power</h3>
                        <p>Outbound control across cities based on firm ownership links</p>
                    </div>
                    <div class="keyword-card">
                        <h3>Relational Prestige</h3>
                        <p>Inbound connections that signal reputation and significance</p>
                    </div>

                    <div class="keyword-card">
                        <h3>Multilevel Control</h3>
                        <p>Global HQ → Regional HQ → Production / R&D → Local subsidiaries</p>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- 第三张也是第一张贸易总览地图 -->
        <section class="Section3">
            <!-- 这个是顶上的文字部分 -->
            <div class="section-header">
                <h2 class="section-header-animate">
                    Here we show the trade data of the 
                    <span class="highlight">pharmaceutical industry</span> across countries,
                    using an <span class="highlight">interactive map</span> and corresponding legend to interpret the 
                    <span class="highlight">trade volume</span> distribution.
                </h2>
            </div>

            <!-- 这里是主体模块 123 -->
            <div class="map-legend-container">
                <!-- 左侧： 图例 -->
                <div id="Map1BlockLegend">
                    <span class="legend-top">Highest</span>
                    <div class="block-bar">
                        <div class="block" style="background:#08306b;"></div>
                        <div class="block" style="background:#08519c;"></div>
                        <div class="block" style="background:#2171b5;"></div>
                        <div class="block" style="background:#4292c6;"></div>
                        <div class="block" style="background:#6baed6;"></div>
                        <div class="block" style="background:#9ecae1;"></div>
                        <div class="block" style="background:#c6dbef;"></div>
                    </div>
                    <span class="legend-bottom">Lowest</span>
                </div>
                
                <!-- 中间：上部地图，下部切换 -->
                <div class="middle">
                    <div id="map1"></div>

                    <div class="toggle-container">
                        <div class="labels">
                            <span>Total Trade</span>
                            <span>Import</span>
                            <span>Export</span>
                        </div>
                        <div class="switch">
                            <input type="range" min="0" max="2" value="0" id="projectionToggle">
                            <div class="track"></div>
                            <div class="thumb"></div>
                        </div>
                    </div>
                </div>

                <!-- 右侧：图表区 -->
                <div class="chart">
                    <div class="rank">
                        <p>Ranking (Total trade)</p>
                        <div class="treecontent">
                            <svg id="d3-treemap" width="300" height="300"></svg>
                        </div>
                    </div>
                    <div class="pie">
                        <p class="pie-chart-title">Global Import / Export</p>
                        <div class="piecontent"></div>
                        <div class="pie-legend">
                            <div><span class="dot import-dot"></span> Import</div>
                            <div><span class="dot export-dot"></span> Export</div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        

        <section class="Section4">
            <h1><strong>Borui words</strong></h1>
            <a href="#section5" class="btn btn-primary">explore</a>

        </section>

        <section class="Section5" id="section5">
            <div id="top-panel" style="position: relative;">
                <div id="mapbubble"></div>
                <div id="border-legend" style="
                position: absolute;
                bottom: 20px;
                left: 20px;
                background: rgba(255,255,255,0.95);
                padding: 10px 14px;
                border-radius: 6px;
                font-size: 13px;
                z-index: 999;
                box-shadow: 0 0 6px rgba(0,0,0,0.1);
                pointer-events: none;">
                    <div style="font-weight: bold; margin-bottom: 6px;">Legend</div>
                    <div style="display: flex; align-items: center; margin-bottom: 4px;">
                        <svg width="22" height="22" style="margin-right: 6px;">
                            <circle cx="11" cy="11" r="9" fill="#f0f0f0" stroke="#2980b9" stroke-width="2" />
                        </svg>
                        <span>Single-function</span>
                    </div>
                    <div style="display: flex; align-items: center;">
                        <svg width="22" height="22" style="margin-right: 6px;">
                            <circle cx="11" cy="11" r="9" fill="#f0f0f0" stroke="#ffffff" stroke-width="2" />
                        </svg>
                        <span>Multi-functional</span>
                    </div>
                </div>
            </div>
            <div id="bottom-panel">
                <div id="filter-panel">
                    <h3>Function Type Filter</h3>
                    <label><input type="checkbox" value="R&D" checked> R&D</label>
                    <label><input type="checkbox" value="Manufacturing" checked> Manufacturing</label>
                    <label><input type="checkbox" value="Packaging" checked> Packaging</label>
                    <label><input type="checkbox" value="Wholesale" checked> Wholesale</label>
                    <label><input type="checkbox" value="Retail/Medical" checked> Retail/Medical</label>
                    <label><input type="checkbox" value="API" checked> API</label>
                    <label><input type="checkbox" value="Support/Other" checked> Support/Other</label>
                    <div style="margin-top:12px;"><label>Company counts ≥ <input type="number" id="minCompanyCount" value="1" min="0"></label></div>
                    <button id="applyFilterBtn">Apply Filter</button>
                </div>
                <div id="top-cities">
                    <input id="cityRangeSlider" type="range" min="10" max="50" step="1" value="10" style="width:100%; margin-bottom:10px;">
                    <canvas id="stackedBarChart"></canvas>
                </div>
                <div id="function-legend">
                    <strong style="display:block; margin-bottom:10px;">Function Type Legend</strong>
                    <div><span class="legend-box" style="background:#4CAF50;"></span> R&D</div>
                    <div><span class="legend-box" style="background:#2196F3;"></span> Manufacturing</div>
                    <div><span class="legend-box" style="background:#FF9800;"></span> Sales</div>
                    <div><span class="legend-box" style="background:#9C27B0;"></span> Packaging</div>
                    <div><span class="legend-box" style="background:#607D8B;"></span> Support/Other</div>
                    <div><span class="legend-box" style="background:#cccccc;"></span> Unclassified</div>
                </div>
            </div>
            <div id="popup">
                <div id="defaultMessage">
                    <h4 style="color:#666; margin-top:0;">Exploring the Global Urban Network of Pharmaceutical Functions</h4>
                    <p>This platform visualizes the spatial organization of the global pharmaceutical industry by mapping cities based on their functional roles. Each bubble on the map encodes <strong>company presence</strong> (size) and <strong>dominant function type</strong> (color), allowing users to intuitively grasp industry footprints across scales.</p>
                    <p>Click on any city bubble to access a detailed functional breakdown via a dynamic donut chart. The right-hand panel will display classification, company count, and distribution by function, while the bottom bar chart summarizes leading cities within the selected zoom level or filters.</p>
                    <div id="mini-scatter-container" style="width:100%; max-width:320px; height:200px; background:rgba(255,255,255,0.95); margin:20px auto;">
                        <canvas id="scatterCanvas" width="320" height="200" style="background:transparent;"></canvas>
                    </div>
                </div>
                <div id="cityDetails" style="display:none;">
                    <button id="backButton" class="back-button"><span class="icon">←</span> Back to Overview</button>
                    <div id="cityHeader"></div>
                    <div id="functionCategory"></div>
                    <div id="cityStats">
                        <p><strong>Function Category:</strong> <span id="functionCategory"></span></p>
                    </div>
                    <canvas id="donutChart"></canvas>
                    </div>
            </div>
        </section>

        <section class="Section6">
            <h1><strong>Qiu words</strong></h1>
            <a href="#section7" class="btn btn-primary">explore</a>
        </section>

        <section class="Section7">
            <h1>page7</h1>
            <p>待定</p>
        </section>

        <!-- huxinyue -->
        <section class="Section8">
            <div id="map">
                <div id="citySelector">
                    <label for="cityDropdown">Select City:</label>
                    <select id="cityDropdown">
                        <option value="">please select city</option>
                    </select>
                </div>
                <div id="legend">
                    <div><span style="background-color: rgb(158, 193, 207);"></span> environmentally oriented city</div>
                    <div><span style="background-color: rgb(168, 213, 186);"></span> Socially orientated city</div>
                    <div><span style="background-color: rgb(203, 170, 203);"></span> Governance-oriented city</div>
                </div>
            </div>
            
            <div class="menu">
                <div id="radar">
                    <canvas id="radarChart" width="300" height="300"></canvas>
                </div>
                <div id="rank">
                    <canvas id="rankingChart"></canvas>
                </div>
            </div>

            <button id="gotoComparison" style="
                       position: absolute; top: 100px; right: 580px; z-index: 9999;
                       background-color: white; border: 1px solid #ccc;
                       padding: 5px 10px; cursor: pointer;">Enter the Comparison Model
            </button>
        </section>

        <!-- TeamIntro -->
        <section class="Team" id="Team">
            <h1><strong>Team</strong></h1>
            <div class="TeamIntro">
                <div class="member">
                    <div class="member1pic"></div>
                    <p>Borui Wang</p>
                </div>
                <div class="member">
                    <div class="member2pic"></div>
                    <p>Qiu Yue</p>
                </div>
                <div class="member">
                    <div class="member3pic"></div>
                    <p>Xinyue Hu</p>
                </div>
                <div class="member">
                    <div class="member4pic"></div>
                    <p>Yifan Wu</p>
                </div>
                <!-- 这里加一行小字：按照字母顺序排列 -->
            </div>
        </section>

        <section class="DataReference">
            <p>这里放数据和refer</p>
        </section>
    </main>

    <footer>
        <div class="footer-content">
            <p>
                &copy; 2025 Centre for Advanced Spatial Analysis, University College London
                |
                <a href="https://github.com/Van-Wu1/CASA0025_GroupWork.git" target="_blank">GitHub</a>
            </p>
        </div>
    </footer>

    <script src="./js/navbar.js" defer></script>
    <script src="./js/home.js"></script>
    <script src="./js/resilience.js"></script>
    <script src="./js/bubble_init.js"></script>
    <script src="./js/bubble_logic.js"></script>

</body>
</html>